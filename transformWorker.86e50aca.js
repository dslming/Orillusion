(function(){"use strict";function V(a,c,n,s,t){const l=t*16,N=Math.cos,O=Math.sin,j=n.x[t]/2,q=n.y[t]/2,v=n.z[t]/2,z=N(j),d=N(q),M=N(v),e=O(j),h=O(q),r=O(v),y=e*d*M+z*h*r,w=z*h*M-e*d*r,S=z*d*r+e*h*M,U=z*d*M-e*h*r,A=y+y,b=w+w,g=S+S,B=y*A,C=y*b,F=y*g,G=w*b,H=w*g,J=S*g,K=U*A,Q=U*b,R=U*g,k=s.x[t],D=s.y[t],L=s.z[t];a[l+0]=(1-(G+J))*k,a[l+1]=(C+R)*k,a[l+2]=(F-Q)*k,a[l+3]=0,a[l+4]=(C-R)*D,a[l+5]=(1-(B+J))*D,a[l+6]=(H+K)*D,a[l+7]=0,a[l+8]=(F+Q)*L,a[l+9]=(H-K)*L,a[l+10]=(1-(B+G))*L,a[l+11]=0,a[l+12]=c.x[t],a[l+13]=c.y[t],a[l+14]=c.z[t],a[l+15]=1}function W(a,c,n){a[n+0]=c[n+0],a[n+1]=c[n+1],a[n+2]=c[n+2],a[n+3]=c[n+3],a[n+4]=c[n+4],a[n+5]=c[n+5],a[n+6]=c[n+6],a[n+7]=c[n+7],a[n+8]=c[n+8],a[n+9]=c[n+9],a[n+10]=c[n+10],a[n+11]=c[n+11],a[n+12]=c[n+12],a[n+13]=c[n+13],a[n+14]=c[n+14],a[n+15]=c[n+15]}let E,I,i,x,P,T,X,Z,p;onmessage=function(a){if(a.data.type)a.data.type==="init"?(x=a.data.ids,P=a.data.parents,T=a.data.position,X=a.data.scale,Z=a.data.rotation,p=a.data.transform,E=a.data.index,I=a.data.poolSize,i=Math.ceil(x.length/I)):a.data.type==="update"&&(x=a.data.ids,i=Math.ceil(x.length/I));else{let c=performance.now();for(let s=E*i,t=E*i+i;s<t;++s){let l=x[s];if(!l)break;Y(l)}let n=performance.now();postMessage(n-c)}};function Y(a){if(p.needUpdate[a]){let c=a*16;V(p.localMatrix,T,Z,X,a),P[a]===0&&W(p.worldMatrix,p.localMatrix,c)}}})();
